<div class="page">
  <div class="page-header">
    <div class="flex items-center">
      <button class="btn btn-outline border-0" (click)="navigateBack()">
        <i class="pi pi-angle-right text-2xl"></i>
      </button>
      <h1 class="page-header-title">
        تفاصيل المشروع
      </h1>
    </div>
    <button
      *appAccessControl="[SystemRoles.ADMIN, SystemRoles.Supervisor]"
        class="btn btn-primary"
        (click)="navigateToPayloadsPerProject()"
      >
        <span>حمولات المشروع</span>
    </button>
  </div>
  <div class="page-content">
    <p-card class="px-0">
      <div class="project-details">
        <div class="project-info">
          <div class="w-full md:w-1/2">
            <h2 class="font-bold my-3 md:mt-0">
              عامة:
            </h2>
            <div class="project-info-wrapper">
              <p class="project-info-head">الاسم:</p>
              <p
                class="truncate-text"
                [pTooltip]="project?.name"
                tooltipPosition="bottom"
              >
                {{ project?.name }}
              </p>
            </div>
            <div class="project-info-wrapper">
              <p class="project-info-head">الموارد:</p>
              <p
                class="truncate-text"
                [pTooltip]="project?.resource"
                tooltipPosition="bottom"
              >
                {{ project?.resource }}
              </p>
            </div>
            <div class="project-info-wrapper">
              <p class="project-info-head">إجمالي الكمية:</p>
              <p
                class="truncate-text"
                [pTooltip]="project?.totalQuantity"
                tooltipPosition="bottom"
              >
                {{ project?.totalQuantity }}
              </p>
            </div>
          </div>
          <div class="w-full md:w-1/2">
            <h2 class="font-bold my-3 md:mt-0">
              الموردون:
            </h2>
            @for (item of project?.supplierList; track $index) {
            <div class="project-info-wrapper">
              <p class="project-info-head">{{ item.name === 'Arish' ? 'العريش' : 'بنى سويف'}}:</p>
              <p
                class="truncate-text"
                [pTooltip]="item?.quantity?.toString()"
                tooltipPosition="bottom"
              >
                {{ item?.quantity }}
              </p>
            </div>
            }
          </div>
        </div>
      </div>
    </p-card>
  </div>
  <div class="page-content">
    <!-- Project details Companies -->
    <p-card class="px-0 mt-3">
      <p-table
        [value]="project?.companyList || []"
        [responsiveLayout]="'scroll'"
        styleClass="p-datatable-striped"
        [scrollable]="true"
      >
        <ng-template pTemplate="header">
          <tr>
            <th>#</th>
            <th>الاسم</th>
            <th>المعرف</th>
            <th>الإجراءات</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-item let-index="rowIndex">
          <tr>
            <td>{{ index + 1 }}</td>
            <td>{{ item.name }}</td>
            <td>{{ item.id || "-" }}</td>
            <td>
              <div class="flex gap-10">
                <button
                  class="btn btn-outline border-0"
                  (click)="navigateToPayloads(item.id)"
                >
                  قائمة الحمولات
                </button>
              </div>
            </td>
          </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
          <tr>
            <td colspan="4" class="text-center">لم يتم العثور على نتائج.</td>
          </tr>
        </ng-template>
      </p-table>
    </p-card>
  </div>
</div>
