<div class="page">
  <div class="page-header">
    <h1 class="page-header-title">المستخدمون</h1>
    <button class="btn btn-primary" (click)="createUser()" *appAccessControl="[Role.ADMIN]">
      <i class="pi pi-plus"></i>
      <span>جديد</span>
    </button>
  </div>

  <div class="page-content">
    <p-card class="px-0">
      <p-table
        [value]="data"
        [responsiveLayout]="'scroll'"
        styleClass="p-datatable-striped"
        [scrollable]="true"
      >
        <ng-template pTemplate="header">
          <tr>
            <th >اسم المستخدم</th>
            <th>الدور</th>
            <th>الشركة</th>
            <th>المشروع</th>
            <th *appAccessControl="[Role.ADMIN]">الإجراءات</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-item>
          <tr>
            <td >{{ item.username }}</td>
            <td>{{ item.role }}</td>
            <td>{{ item.companyName || "-" }}</td>
            <td>{{ item.projectName || "-" }}</td>
            <td *appAccessControl="[Role.ADMIN]">
              <div class="flex gap-10">
                  <button
                    class="btn btn-outline border-0"
                    (click)="editUser(item.id)"
                  >
                    <i class="pi pi-pencil ca-text-info ca-font-bold"></i>
                  </button>
                <button
                  class="btn btn-outline border-0"
                  (click)="confirmDelete(item.id)"
                >
                  <i class="pi pi-trash ca-text-error ca-font-bold"></i>
                </button>
              </div>
            </td>
          </tr>
        </ng-template>
        <ng-template pTemplate="empty">
          <tr>
            <td colspan="3" class="text-center">لم يتم العثور على مستخدمين.</td>
          </tr>
        </ng-template>
      </p-table>
      <app-pagination
        [paginationConfig]="pagination"
        (onPageChange)="onPageChange($event)"
      />
    </p-card>
  </div>
</div>
